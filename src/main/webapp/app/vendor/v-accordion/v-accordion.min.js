/**
 * vAccordion - AngularJS multi-level accordion component
 * @version v0.2.6
 * @link http://lukaszwatroba.github.io/v-accordion
 * @author Łukasz Wątroba <l@lukaszwatroba.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */

!function(n){"use strict";function e(e){return{restrict:"EA",replace:!0,transclude:!0,template:"<div ng-transclude></div>",scope:{control:"=?",allowMultiple:"=?"},controllerAs:"accordionCtrl",controller:o,compile:function(o){return o.addClass(e.classes.accordion),function(e,o,t){function i(){n.forEach(a,function(n){if(e.control[n])throw new Error("The `"+n+"` method can not be overwritten")})}function l(){if(!n.isFunction(e.control.onExpand))throw new Error("The `onExpand` callback must be a function");if(!n.isFunction(e.control.onCollapse))throw new Error("The `onCollapse` callback must be a function")}n.isDefined(e.allowMultiple)||(e.allowMultiple=n.isDefined(t.allowMultiple));var a=["toggle","expand","collapse","expandAll","collapseAll"];e.$watch("control",function(){if(e.control&&e.control!==e.internalControl){i();var o=n.extend({},e.internalControl,e.control);e.control=e.internalControl=o,l()}else n.isDefined(e.control)||(e.control=e.internalControl)})}}}}function o(e){var o=this;e.isDisabled=!1,e.panes=[];var t=function(){for(var n=!1,o=0,t=e.panes.length;t>o;o++){var i=e.panes[o];if(i.isExpanded){n=!0;break}}return n},i=function(n){return e.panes[n]},l=function(n){return e.panes.indexOf(n)};o.disable=function(){e.isDisabled=!0},o.enable=function(){e.isDisabled=!1},o.addPane=function(n){if(!e.allowMultiple&&t()&&n.isExpanded)throw new Error("The `allow-multiple` attribute is not set");e.panes.push(n),n.isExpanded&&e.internalControl.onExpand(l(n))},o.toggle=function(n){!e.isDisabled&&n&&(e.allowMultiple||o.collapseAll(n),n.isExpanded=!n.isExpanded,n.isExpanded?e.internalControl.onExpand(l(n)):e.internalControl.onCollapse(l(n)))},o.expand=function(n){!e.isDisabled&&n&&(e.allowMultiple||o.collapseAll(n),n.isExpanded||(n.isExpanded=!0,e.internalControl.onExpand(l(n))))},o.collapse=function(n){!e.isDisabled&&n&&n.isExpanded&&(n.isExpanded=!1,e.internalControl.onCollapse(l(n)))},o.expandAll=function(){if(!e.isDisabled){if(!e.allowMultiple)throw new Error("The `allow-multiple` attribute can't be found");n.forEach(e.panes,function(n){o.expand(n)})}},o.collapseAll=function(t){e.isDisabled||n.forEach(e.panes,function(n){n!==t&&o.collapse(n)})},e.internalControl={toggle:function(n){o.toggle(i(n))},expand:function(n){o.expand(i(n))},collapse:function(n){o.collapse(i(n))},expandAll:o.expandAll,collapseAll:o.collapseAll,onExpand:function(){},onCollapse:function(){}}}function t(n){return{restrict:"EA",require:"^vPane",transclude:!0,replace:!0,template:"<div><div ng-transclude></div></div>",scope:{},compile:function(e){return e.addClass(n.classes.paneContent),function(n,e,o,t){n.paneCtrl=t}}}}function i(n){return{restrict:"EA",require:"^vPane",transclude:!0,replace:!0,template:'<div ng-click="paneCtrl.toggle()"><div ng-transclude></div></div>',scope:{},compile:function(e){return e.addClass(n.classes.paneHeader),function(n,e,o,t){n.paneCtrl=t}}}}function l(e,o,t){return{restrict:"EA",require:"^vAccordion",transclude:!0,replace:!0,template:"<div ng-transclude></div>",scope:{isExpanded:"=?expanded"},controllerAs:"paneCtrl",controller:a,compile:function(i){return i.addClass(t.classes.pane),function(i,l,a,c){function r(){c.disable();var n=u.offsetHeight;p.style.maxHeight="0px",e(function(){o.addClass(v,x).then(function(){c.enable(),p.style.maxHeight="none"}),setTimeout(function(){p.style.maxHeight=n+"px"},0)},0),l.addClass(x),f.addClass(x)}function d(){c.disable();var n=u.offsetHeight;p.style.maxHeight=n+"px",e(function(){o.removeClass(v,x).then(function(){c.enable()}),setTimeout(function(){p.style.maxHeight="0px"},0)},0),l.removeClass(x),f.removeClass(x)}n.isDefined(i.isExpanded)||(i.isExpanded=n.isDefined(a.expanded));var s=l[0].querySelector("."+t.classes.paneHeader),p=l[0].querySelector("."+t.classes.paneContent);if(!s)throw new Error("The `v-pane-header` directive can't be found");if(!p)throw new Error("The `v-pane-content` directive can't be found");var u=p.querySelector("div"),f=n.element(s),v=n.element(p),x=t.classes.expandedState;c.addPane(i),i.accordionCtrl=c,p.style.maxHeight="0px",e(function(){i.isExpanded&&r()},100),i.$watch("isExpanded",function(n,e){return n===e?!0:(n?r():d(),void 0)})}}}}function a(n){var e=this;e.toggle=function(){n.isAnimating||n.accordionCtrl.toggle(n)}}n.module("vAccordion.config",[]).constant("accordionConfig",{classes:{accordion:"Accordion Accordion--dafault",pane:"Accordion-pane",paneHeader:"Accordion-paneHeader",paneContent:"Accordion-paneContent",expandedState:"is-expanded"}}),n.module("vAccordion.directives",["ngAnimate"]),n.module("vAccordion",["vAccordion.config","vAccordion.directives"]),n.module("vAccordion.directives").directive("vAccordion",e),e.$inject=["accordionConfig"],o.$inject=["$scope"],n.module("vAccordion.directives").directive("vPaneContent",t),t.$inject=["accordionConfig"],n.module("vAccordion.directives").directive("vPaneHeader",i),i.$inject=["accordionConfig"],n.module("vAccordion.directives").directive("vPane",l),l.$inject=["$timeout","$animate","accordionConfig"],a.$inject=["$scope"]}(angular);